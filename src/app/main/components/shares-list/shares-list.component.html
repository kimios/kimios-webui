<div  [ngClass]="'kimios-section-content'">

<form *ngIf="mode === 'byMe'" [formGroup]="form">
  <div
          fxLayout="column">
    <div
            [formGroupName]="'statusFilters'"
            fxLayout="row"
            style="padding: 5px; margin-left: 20px; margin-top: 25px"
            fxLayoutGap="10px"
            fxLayoutAlign="start center">
      <span style="vertical-align: bottom">Filter by status: </span>
      <mat-checkbox *ngFor="let statusType of shareStatusTypes"
                    [formControlName]="statusType"
                    labelPosition="after">
        {{statusType}}
      </mat-checkbox>
    </div>
  </div>
</form>

<mat-table
        *ngIf="dataSource != null"
        [dataSource]="dataSource"
        matSort
        matSortActive="{{sort.name}}"
        matSortDirection="{{sort.direction}}"
        matSortDisableClear
        (matSortChange)="sortData($event)"
        [ngClass]="{'kimios-share-mat-table' : mode === 'byMe'}"
        [formGroup]="formGroupFilters"
>

  <!-- remove Column -->
  <ng-container matColumnDef="remove">
    <mat-cell *matCellDef="let row">
      <mat-icon [ngClass]="'cursor-pointer'" (click)="endShare(row.id)" >remove</mat-icon>
    </mat-cell>
  </ng-container>

  <!--<ng-container matColumnDef="checkbox">
    <mat-header-cell *matHeaderCellDef>

    </mat-header-cell>
    <mat-cell *matCellDef="let row">
      <mat-checkbox [formControlName]="row.id"></mat-checkbox>
    </mat-cell>
  </ng-container>-->

  <ng-container
          *ngFor="let col of columnsDescription"
          matColumnDef="{{col.matColumnDef}}"
          sticky="{{col.sticky}}">
    <mat-header-cell
            *matHeaderCellDef
            mat-sort-header="{{col.matColumnDef}}"
    >
      {{col.displayName}}
    </mat-header-cell>
    <mat-cell *matCellDef="let element" [class.cursor-pointer]="true" title="{{col.title ? col.title(element) : ''}}">
      <fa-icon *ngIf="col.id == 'entity'"
               [icon]="['far', retrieveDocumentIcon(element.entity, 'far')]"
               size="lg"
               [ngClass]="'file-icon-list'"></fa-icon>
      <span *ngIf="col.id != 'with'">{{col.cell ? col.cell(element) : element[col.matColumnDef]}}</span>
      <span *ngIf="col.id === 'with' && element.targetUser != null">
        {{element.targetUser.lastName
      + ', '
      + element.targetUser.firstName }}
      </span>
    </mat-cell>
  </ng-container>


  <ng-container
          *ngFor="let col of displayedColumnsWithFilters"
          matColumnDef="{{col}}">
    <mat-header-cell
            *matHeaderCellDef
    >
      <mat-form-field>
        <input type="text"
               matInput aria-label="Filter shares" [formControlName]="col" placeholder="search">
        <button mat-button *ngIf="this.formGroupFilters.get(col).value.length > 0"
                matSuffix mat-icon-button aria-label="Clear" (click)="this.formGroupFilters.get(col).setValue('')">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>
    </mat-header-cell>
  </ng-container>


  <mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"
                  [ngClass]="'kimios-first-of-several-headers'" >
  </mat-header-row>
  <mat-header-row *matHeaderRowDef="displayedColumnsWithFilters; sticky: true"
                  style="height: 36px;">
  </mat-header-row>

  <mat-row *matRowDef="let row; columns: displayedColumns;" >
  </mat-row>

</mat-table>
<ng-container *ngIf="dataSource.connect() | async as dataSourceConnection">
  <div *ngIf="dataSourceConnection.length === 0" style="width: 100%" fxLayout="row" fxLayoutAlign="center"
       [ngClass]="'kimios-section-content'">
    <p style="font-style: italic;">no items found</p>
  </div>
</ng-container>

</div>
