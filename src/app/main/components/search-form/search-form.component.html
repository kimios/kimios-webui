<form [ngClass]="'full-width'" #form
      [formGroup]="searchFormGroup"
      (ngSubmit)="onSubmit()"
      (keyup)="$event.key === 'Enter' ? onSubmit():1"
      style="margin-top: 20px">

  <div fxFill fxLayout="column" fxLayoutAlign="space-between start">

  <div fxFill fxLayout="row" fxLayoutAlign="space-between start">

    <div fxFill fxLayout="column" fxLayoutAlign="space-between start" fxFlex="45">

    <mat-form-field class="example-full-width" fxFill>
      <input type="text" placeholder="Document name" aria-label="document's name" matInput [formControlName]="'name'"
             [matAutocomplete]="autoCompleteDocumentName">
      <mat-autocomplete #autoCompleteDocumentName="matAutocomplete" (optionSelected)="selectedDocumentName()">
        <mat-option *ngFor="let option of filteredDocuments$ | async" [value]="option">
          {{option.path}}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>

    <mat-form-field class="example-full-width" fxFill>
      <input type="text" placeholder="Content" aria-label="document's content" matInput [formControlName]="'content'">
    </mat-form-field>

    <mat-form-field class="example-full-width" fxFill>
      <input type="text" placeholder="Owner" aria-label="document's owner" matInput [formControlName]="'owner'"
             [matAutocomplete]="autoCompleteDocumentOwner" >
      <mat-icon matSuffix [ngClass]="'cursor-pointer'" (click)="openUserList()">people</mat-icon>
      <mat-autocomplete #autoCompleteDocumentOwner="matAutocomplete" (optionSelected)="selectedUser()">
        <mat-option *ngFor="let option of filteredUsers$ | async" [value]="option">
          {{option.name + ', ' + option.firstName + ' (' + option.name + '@' + option.source + ')'}}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>

      <ng-container *ngIf="allTags$ | async as allTagsData" >
        <mat-form-field class="example-full-width" fxFill>
          <input
                  matInput [formControlName]="'tagInput'"
                  placeholder="Tags"
                  #tagInput
                  [ngClass]="'tagInput'"
                  [matChipInputFor]="chipList"
                  [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                  [matChipInputAddOnBlur]="addOnBlur"
                  [matAutocomplete]="auto"
          >
        </mat-form-field>
        <mat-chip-list #chipList>
          <mat-chip
                  *ngFor="let tag of this.selectedTags"
                  [removable]="true"
                  (removed)="unselectTag(tag)"
          >
            {{tag}}
            <mat-icon matChipRemove >cancel</mat-icon>
          </mat-chip>
          <mat-autocomplete #auto="matAutocomplete" (optionSelected)="selectedTag($event.option.value)">
            <mat-option *ngFor="let tag of filteredTags$ | async" [value]="tag">
              {{tag}}
            </mat-option>
          </mat-autocomplete>
        </mat-chip-list>
      </ng-container>

    </div>

    <div fxFill fxLayout="column" fxLayoutAlign="space-between start" fxFlex="45">

    <mat-form-field class="example-full-width" fxFill>
      <input type="text" placeholder="Document id" aria-label="document's id" matInput [formControlName]="'id'">
    </mat-form-field>

    <mat-form-field class="example-full-width" fxFill>
      <input type="text" placeholder="Folder" aria-label="document's folder" matInput [formControlName]="'folder'" >
      <mat-icon matSuffix [ngClass]="'cursor-pointer'" (click)="openFolderTree()">folder_open</mat-icon>
    </mat-form-field>

    <mat-form-field fxFlex="45">
      <input matInput [matDatepicker]="dateMinPicker" placeholder="Date min" [formControlName]="'dateMin'">
      <mat-datepicker-toggle matSuffix [for]="dateMinPicker"></mat-datepicker-toggle>
      <mat-datepicker #dateMinPicker></mat-datepicker>
    </mat-form-field>

    <mat-form-field fxFlex="45">
      <input matInput [matDatepicker]="dateMaxPicker" placeholder="Date max" [formControlName]="'dateMax'">
      <mat-datepicker-toggle matSuffix [for]="dateMaxPicker"></mat-datepicker-toggle>
      <mat-datepicker #dateMaxPicker></mat-datepicker>
    </mat-form-field>

    </div>

  </div>

    <div style="margin-top: 20px; width: 100%;">
      <div fxLayout="row"
           fxLayoutAlign="center center"
           fxLayoutGap="20px"
           fxFill
           style="margin-top: 20px !important;">
        <div [class.kimios-button]="true"
             [class.kimios-green]="true"
             [class.inactive]="true"
             fxLayout="row"
             fxLayoutAlign="center center"
             matDialogClose>
          <span [class.kimios-button-text]="true">CANCEL</span>
        </div>
        <div [class.kimios-button]="true"
             [class.kimios-green]="true"
             [class.active]="true"
             fxLayout="row"
             fxLayoutAlign="center center"
             (click)="onSubmit()">
          <span class="kimios-button-text">SEARCH</span>
        </div>
      </div>
    </div>

  </div>

</form>
