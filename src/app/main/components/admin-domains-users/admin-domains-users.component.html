<!--<ng-container *ngIf="users$ | async as users">-->
  <!--<form [formGroup]="formGroup" (ngSubmit)="onSubmit()">-->

    <div fxLayout="column" fxLayoutGap="5px">

      <div fxLayout="row">
        <div *ngIf="modeIsAdmin()" fxFlex="70">
        <form (ngSubmit)="filterUsers()">
          <mat-form-field style="width: 90%;">
            <input #inputUserSearch type="text" name="inputFilename" matInput aria-label="Tags" [formControl]="userSearch"
                   [matAutocomplete]="autoUserSearch" placeholder="login or name">
            <button mat-button (click)="filterUsers()" >
              <mat-icon>search</mat-icon>
            </button>
            <mat-autocomplete #autoUserSearch="matAutocomplete" fxFlex="40" [displayWith]="displayFn">
              <mat-option *ngFor="let user of filteredUsers$ | async" placeholder="File name" [value]="user"
                          (click)="showUser(user)" >
                <span>{{user.lastName}}, {{user.firstName}} ({{user.uid}}@{{user.source}})</span>
              </mat-option>
            </mat-autocomplete>
          </mat-form-field>
        </form>
        </div>

        <div *ngIf="_mode === 'addToRole'" fxFlex>
          <!--<ng-container *ngIf="selectedDomain$ | async as selectedDom">-->
            <mat-select
                    [formControl]="selectDomain"
            >
              <mat-option
                      *ngFor="let domain of domains$ | async"
                      [value]="domain.name"
              >
                {{domain.name}}
              </mat-option>
            </mat-select>
          <!--</ng-container>-->
        </div>

        <ng-container *ngIf="modeIsAdmin() || _mode === 'roles'">
        <div>
          <button (click)="openDialog()"><mat-icon>add</mat-icon></button>
        </div>
        </ng-container>

      </div>

      <form [formGroup]="usersToAddToRole" >
      <mat-table [dataSource]="dataSource"
                 matSort
                 matSortActive="{{sort.name}}"
                 matSortDirection="{{sort.direction}}"
                 matSortDisableClear
                 (matSortChange)="sortData($event)">

        <!-- remove Column -->
        <ng-container *ngIf="_mode === 'roles'" matColumnDef="remove">
          <mat-header-cell *matHeaderCellDef>

          </mat-header-cell>
          <mat-cell *matCellDef="let row">
            <mat-icon [ngClass]="'cursor-pointer'" (click)="removeUserFromRole(row)" >remove</mat-icon>
          </mat-cell>
        </ng-container>

        <ng-container *ngIf="_mode === 'addToRole'" matColumnDef="checkbox">
          <mat-header-cell *matHeaderCellDef>

          </mat-header-cell>
          <mat-cell *matCellDef="let row">
            <mat-checkbox [formControlName]="row.uid"></mat-checkbox>
          </mat-cell>
        </ng-container>

        <ng-container
                *ngFor="let col of columnsDescription"
                matColumnDef="{{col.matColumnDef}}"
                sticky="{{col.sticky}}">
          <mat-header-cell
                  *matHeaderCellDef
                  mat-sort-header="{{col.matColumnDef}}"
          > {{col.displayName}} </mat-header-cell>
          <mat-cell *matCellDef="let element" [class.cursor-pointer]="true">
            <span *ngIf="col.id != 'icon'">{{ col.cell ? col.cell(element) : element[col.matColumnDef]}}</span>
          </mat-cell>
        </ng-container>

        <mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>

        <mat-row *matRowDef="let row; columns: displayedColumns;" (dblclick)="showUser(row)" >
        </mat-row>

      </mat-table>

      <mat-paginator *ngIf="modeIsAdmin()"
              [length]="totalNbElements"
              [pageSize]="pageSize"
              [pageSizeOptions]="pageOptions"
              (page)="handlePageEvent($event)">
      </mat-paginator>

      </form>

    </div>
  <!--</form>-->

<!--</ng-container>-->
